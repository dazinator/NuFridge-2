<template>
    <h1>${showForm ? 'Import Packages' : 'Importing Packages'}</h1>

    <div class="ui segment" if.bind="showForm">
        <form class="ui form">
            <div class="field">
                <label>Feed URL</label>
                <p>
                    The feed URL to import packages from. Example: <a target="_blank" href="https://www.nuget.org/api/v2">https://www.nuget.org/api/v2</a>
                </p>
                <input type="text" name="feedUrl" value.bind="options.FeedUrl">
            </div>
            <div class="field">
                <div class="inline field">
                    <div class="ui toggle checkbox includePrerelease">
                        <input type="checkbox" checked.bind="options.IncludePrerelease">
                        <label style="font-size: .9285em; font-weight: 700;">Include pre-release packages</label>
                    </div>
                </div>
            </div>
            <div class="field">
                <div class="inline field">
                    <div class="ui toggle checkbox checkLocalCache">
                        <input type="checkbox" checked.bind="options.CheckLocalCache">
                        <label style="font-size: .9285em; font-weight: 700;">Include local packages</label>
                    </div>
                </div>
            </div>
            <div class="ui buttons">
                <button class="ui positive button" click.trigger="startImport()">Import Packages</button>
            </div>
        </form>
    </div>

    <div class="ui pointing secondary menu importMenu" show.bind="showProgress">
        <a class="item active" data-tab="first">Overview</a>
        <a class="item" data-tab="second">Packages</a>
    </div>

    <div show.bind="showProgress">
        <div data-tab="first" class="ui bottom tab segment active">
            <table class="ui collapsing table">
                <thead>
                <tr>
                    <th>Packages Imported</th>
                    <th>Packages Failed</th>
                    <th>Packages Remaining</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>${packagesImportedCount}</td>
                    <td> ${packagesFailedCount}</td>
                    <td> ${job.Scheduled}</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div data-tab="second" class="ui bottom tab segment">
            <div class="ui importList">
                <div class="ui message importItem" repeat.for="item of items">
                    <div class="header">
                        <a class="ui red label" if.bind="item.Success === false && item.CompletedAt">Failed</a>
                        <a class="ui green label" if.bind="item.Success === true && item.CompletedAt">Success</a>
                        <i click.trigger="$parent.packageClick(item)" class="${item.IsExpanded ? 'minus square' : 'add square'} icon"></i>
                        <span class="importTitle" click.trigger="$parent.packageClick(item)">${item.PackageId} ${item.Version}</span> 
                    </div>

                    <div class="ui message" if.bind="item.IsExpanded">
                        <div class="ui list">
                            <div class="item" repeat.for="log of item.Items"><a class="ui ${$parent.$parent.getLevelColour(log)} label">${log.Level.toUpperCase()}</a> ${log.Message}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>